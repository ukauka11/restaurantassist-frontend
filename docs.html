<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RestaurantAssist • Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css">

  <style>
    /* Page header (matches your vibe) */
    .hero {
      margin-top: 18px;
      padding: 22px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.08);
      background:
        radial-gradient(1200px 420px at 10% 0%, rgba(56,189,248,0.18), transparent 55%),
        radial-gradient(900px 380px at 90% 10%, rgba(34,197,94,0.16), transparent 55%),
        #0b1224;
      box-shadow: 0 10px 24px rgba(0,0,0,0.25);
    }
    .hero h1{ margin:0; font-size: 34px; letter-spacing: -0.3px; color:#fff; }
    .hero .sub{ margin-top:10px; font-size:14px; color:#cbd5e1; line-height:1.6; max-width: 980px; }
    .muted{ color:#94a3b8; font-size: 12px; line-height: 1.5; }
    code{ background: rgba(255,255,255,0.06); padding: 2px 6px; border-radius: 6px; }
    a { color: inherit; }

    /* Docs layout */
    .docsWrap{
      margin-top: 16px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 16px;
      align-items: start;
    }
    @media (max-width: 980px){
      .docsWrap{ grid-template-columns: 1fr; }
      .sideNav{ position: static !important; top:auto !important; }
    }

    .sideNav{
      position: sticky;
      top: 16px;
    }

    .sideNav .navTitle{
      font-weight: 900;
      color: #e2e8f0;
      margin-bottom: 10px;
      font-size: 14px;
      letter-spacing: 0.2px;
    }

    .sideNav a{
      display:block;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.03);
      color: #cbd5e1;
      text-decoration: none;
      margin-bottom: 8px;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
    }
    .sideNav a:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,0.05);
      border-color: rgba(56,189,248,0.25);
    }

    /* Section spacing */
    .docSection{ scroll-margin-top: 90px; }
    .docSection + .docSection{ margin-top: 16px; }

    /* Endpoint cards */
    .endpointHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 10px;
    }
    .endpointHead h2{
      margin:0;
      color:#e2e8f0;
      font-size: 18px;
      letter-spacing: -0.2px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.06);
      color:#cbd5e1;
      font-weight: 900;
      font-size: 12px;
      white-space: nowrap;
    }
    .chip.get{ border-color: rgba(56,189,248,0.35); background: rgba(56,189,248,0.10); color:#bae6fd; }
    .chip.post{ border-color: rgba(34,197,94,0.35); background: rgba(34,197,94,0.10); color:#bbf7d0; }
    .chip.webhook{ border-color: rgba(248,113,113,0.35); background: rgba(248,113,113,0.08); color:#fecaca; }

    /* Code blocks + copy button */
    .codeBox{
      position: relative;
      border: 1px solid rgba(255,255,255,0.08);
      background: #070b16;
      border-radius: 14px;
      padding: 12px;
      overflow: hidden;
    }
    pre{
      margin: 0;
      overflow-x: auto;
      padding-right: 44px;
      color:#e5e7eb;
      line-height: 1.55;
      font-size: 13px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      white-space: pre;
    }
    .copyBtn{
      position:absolute;
      top: 10px;
      right: 10px;
      padding: 8px 10px;
      font-size: 12px;
      font-weight: 900;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.06);
      color: #e2e8f0;
      cursor: pointer;
    }
    .copyBtn:hover{
      border-color: rgba(56,189,248,0.35);
      background: rgba(56,189,248,0.10);
    }

    .kv{
      display:grid;
      grid-template-columns: 160px 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    @media (max-width: 600px){
      .kv{ grid-template-columns: 1fr; }
    }
    .kv .k{ color:#94a3b8; font-size: 12px; }
    .kv .v{ color:#e2e8f0; font-size: 13px; }

    .callout{
      border: 1px solid rgba(56,189,248,0.22);
      background: rgba(56,189,248,0.08);
      border-radius: 14px;
      padding: 12px;
      color: #cbd5e1;
    }
    .callout strong{ color:#e2e8f0; }

    .toast{
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(2,6,23,0.85);
      color:#e5e7eb;
      box-shadow: 0 10px 24px rgba(0,0,0,0.35);
      font-weight: 900;
      font-size: 13px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 160ms ease;
      z-index: 50;
    }
    .toast.show{ opacity: 1; }
  </style>
</head>

<body>
  <div class="container">

    <!-- NAV -->
    <div class="nav">
      <div class="brand"><div class="dot"></div><span>RestaurantAssist</span></div>
      <div class="navlinks">
        <a class="btn" href="/">Home</a>
        <a class="btn" href="/dashboard.html">Dashboard</a>
        <a class="btn" href="/docs.html">Docs</a>
        <a class="btn" href="/support.html">Support</a>
      </div>
    </div>

    <!-- HERO -->
    <div class="hero">
      <h1>Docs</h1>
      <div class="sub">
        These are the advanced docs. Most restaurant owners should use the <a href="/dashboard.html"><strong>Dashboard</strong></a>.
        <div class="muted" style="margin-top:8px;">
          Need help? Email <a href="mailto:support@restaurantassist.app"><strong>support@restaurantassist.app</strong></a>
        </div>
      </div>
    </div>

    <div class="docsWrap">

      <!-- LEFT STICKY NAV -->
      <div class="card sideNav">
        <div class="navTitle">On this page</div>
        <a href="#overview">Overview</a>
        <a href="#auth">Authentication</a>
        <a href="#baseurl">Base URL</a>
        <a href="#quickstart">Quickstart</a>
        <a href="#endpoints">Endpoints</a>
        <a href="#me">GET /me</a>
        <a href="#analyze">POST /analyze</a>
        <a href="#billing">Billing</a>
        <a href="#errors">Errors</a>
        <a href="#recipes">Common recipes</a>
        <a href="#webhooks">Webhooks</a>
        <a href="#troubleshooting">Troubleshooting</a>
        <a href="#changelog">Changelog</a>
      </div>

      <!-- RIGHT CONTENT -->
      <div>

        <!-- OVERVIEW -->
        <div id="overview" class="card docSection">
          <div class="endpointHead">
            <h2>Overview</h2>
            <span class="chip">Advanced</span>
          </div>
          <p style="color:#cbd5e1; line-height:1.7; margin:0;">
            RestaurantAssist is a review-reply workflow tool. Most users paste reviews into the dashboard and copy replies.
            These docs are for developers or advanced users who want to call the API directly.
          </p>

          <div class="kv">
            <div class="k">Support</div>
            <div class="v"><a href="mailto:support@restaurantassist.app">support@restaurantassist.app</a></div>

            <div class="k">Auth</div>
            <div class="v">API key in <code>x-api-key</code> header</div>

            <div class="k">Dashboard</div>
            <div class="v"><a href="/dashboard.html">/dashboard.html</a></div>
          </div>
        </div>

        <!-- AUTH -->
        <div id="auth" class="card docSection">
          <div class="endpointHead">
            <h2>Authentication</h2>
            <span class="chip">API key</span>
          </div>

          <div class="callout">
            <strong>No logins.</strong> Your API key is your identity. After checkout, the key is emailed to you.
            Include it as <code>x-api-key</code> in requests.
          </div>

          <div style="height:12px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-auth">Copy</button>
            <pre id="code-auth"># Example header
x-api-key: YOUR_KEY_HERE</pre>
          </div>

          <div class="muted" style="margin-top:10px;">
            Tip: You can store the key locally in the Dashboard (this device only).
          </div>
        </div>

        <!-- BASE URL -->
        <div id="baseurl" class="card docSection">
          <div class="endpointHead">
            <h2>Base URL</h2>
            <span class="chip">Environment</span>
          </div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-baseurl">Copy</button>
            <pre id="code-baseurl">https://review-assistant-api.onrender.com</pre>
          </div>

          <div class="muted" style="margin-top:10px;">
            Later, you may use a custom domain like <code>api.restaurantassist.app</code>.
          </div>
        </div>

        <!-- QUICKSTART -->
        <div id="quickstart" class="card docSection">
          <div class="endpointHead">
            <h2>Quickstart</h2>
            <span class="chip">1 minute</span>
          </div>

          <p style="color:#cbd5e1; line-height:1.7; margin:0;">
            Make sure you have your API key. Then run:
          </p>

          <div style="height:10px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-quickstart">Copy</button>
            <pre id="code-quickstart">curl -X POST "https://review-assistant-api.onrender.com/analyze" \
  -H "Content-Type: application/json" \
  -H "x-api-key: YOUR_KEY_HERE" \
  -d '{
    "review_text": "Food was great but the wait was really long.",
    "platform": "google"
  }'</pre>
          </div>

          <div class="muted" style="margin-top:10px;">
            If your subscription is inactive, protected requests may return <code>402</code>.
          </div>
        </div>

        <!-- ENDPOINTS -->
        <div id="endpoints" class="card docSection">
          <div class="endpointHead">
            <h2>Endpoints</h2>
            <span class="chip">Reference</span>
          </div>

          <div class="kv">
            <div class="k">Account</div>
            <div class="v"><code>GET /me</code></div>

            <div class="k">Generate reply</div>
            <div class="v"><code>POST /analyze</code></div>

            <div class="k">Stripe checkout</div>
            <div class="v"><code>POST /billing/create-checkout</code></div>

            <div class="k">Provision status</div>
            <div class="v"><code>GET /billing/status?session_id=...</code></div>
          </div>
        </div>

        <!-- GET /me -->
        <div id="me" class="card docSection">
          <div class="endpointHead">
            <h2>GET /me</h2>
            <span class="chip get">GET</span>
          </div>

          <p style="color:#cbd5e1; line-height:1.7; margin:0;">
            Returns the business attached to your API key and subscription info.
          </p>

          <div style="height:10px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-me">Copy</button>
            <pre id="code-me">curl "https://review-assistant-api.onrender.com/me" \
  -H "x-api-key: YOUR_KEY_HERE"</pre>
          </div>

          <div style="height:10px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-me-resp">Copy</button>
            <pre id="code-me-resp">{
  "business_id": "california-pizza-kitchen",
  "email": "you@yourrestaurant.com",
  "subscription": {
    "plan": "starter",
    "status": "active",
    "current_period_end": "2026-02-15"
  }
}</pre>
          </div>
        </div>

        <!-- POST /analyze -->
        <div id="analyze" class="card docSection">
          <div class="endpointHead">
            <h2>POST /analyze</h2>
            <span class="chip post">POST</span>
          </div>

          <p style="color:#cbd5e1; line-height:1.7; margin:0;">
            Analyzes a review and returns a ready-to-post reply. Also returns metadata that the Dashboard may use.
          </p>

          <div class="kv">
            <div class="k">Content-Type</div>
            <div class="v"><code>application/json</code></div>

            <div class="k">Required</div>
            <div class="v"><code>review_text</code></div>

            <div class="k">Optional</div>
            <div class="v"><code>platform</code> (google/yelp/facebook/other)</div>
          </div>

          <div style="height:10px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-analyze">Copy</button>
            <pre id="code-analyze">curl -X POST "https://review-assistant-api.onrender.com/analyze" \
  -H "Content-Type: application/json" \
  -H "x-api-key: YOUR_KEY_HERE" \
  -d '{
    "review_text": "The food was amazing but the order was missing an item.",
    "platform": "google"
  }'</pre>
          </div>

          <div style="height:10px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-analyze-resp">Copy</button>
            <pre id="code-analyze-resp">{
  "record": {
    "reply": "Thanks for letting us know — we’re glad you enjoyed the food, and we’re sorry an item was missed. Please reach out so we can make it right.",
    "sentiment": "mixed",
    "urgency": "high",
    "category": "missing_item",
    "tags": ["missing_item", "apology"],
    "next_steps": [
      "Offer to make it right",
      "Ask for order details (date/time) if appropriate"
    ]
  }
}</pre>
          </div>

          <div class="muted" style="margin-top:10px;">
            Note: The Dashboard may hide most metadata for simplicity.
          </div>
        </div>

        <!-- BILLING -->
        <div id="billing" class="card docSection">
          <div class="endpointHead">
            <h2>Billing</h2>
            <span class="chip">Stripe</span>
          </div>

          <p style="color:#cbd5e1; line-height:1.7; margin:0;">
            Checkout is handled by Stripe subscriptions. After successful checkout, your API key is emailed automatically.
          </p>

          <div style="height:10px;"></div>

          <div class="endpointHead" style="margin-top:6px;">
            <h2 style="font-size:16px; margin:0;">POST /billing/create-checkout</h2>
            <span class="chip post">POST</span>
          </div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-checkout">Copy</button>
            <pre id="code-checkout">curl -X POST "https://review-assistant-api.onrender.com/billing/create-checkout" \
  -H "Content-Type: application/json" \
  -d '{
    "business_id": "california-pizza-kitchen",
    "email": "you@yourrestaurant.com",
    "plan": "starter"
  }'</pre>
          </div>

          <div style="height:12px;"></div>

          <div class="endpointHead">
            <h2 style="font-size:16px; margin:0;">GET /billing/status</h2>
            <span class="chip get">GET</span>
          </div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-status">Copy</button>
            <pre id="code-status">curl "https://review-assistant-api.onrender.com/billing/status?session_id=SESSION_ID_HERE"</pre>
          </div>

          <div class="muted" style="margin-top:10px;">
            While the webhook is processing you may see <code>{"ready": false}</code>. When provisioning is complete you’ll see <code>{"ready": true, ...}</code>.
          </div>
        </div>

        <!-- ERRORS -->
        <div id="errors" class="card docSection">
          <div class="endpointHead">
            <h2>Errors</h2>
            <span class="chip">HTTP</span>
          </div>

          <div class="kv">
            <div class="k">401 / 403</div>
            <div class="v">Missing or invalid API key</div>

            <div class="k">402</div>
            <div class="v">Subscription inactive / past due / canceled</div>

            <div class="k">429</div>
            <div class="v">Rate limit (future)</div>

            <div class="k">5xx</div>
            <div class="v">Server error</div>
          </div>

          <div style="height:10px;"></div>

          <div class="codeBox">
            <button class="copyBtn" data-copy="code-error">Copy</button>
            <pre id="code-error">{
  "detail": "Subscription inactive. Please update billing."
}</pre>
          </div>
        </div>

        <!-- RECIPES -->
        <div id="recipes" class="card docSection">
          <div class="endpointHead">
            <h2>Common recipes</h2>
            <span class="chip">Practical</span>
          </div>

          <div class="boxOut">
            <h3 style="margin:0 0 8px 0; color:#e2e8f0; font-size:16px;">Test if your key works</h3>
            <div class="codeBox">
              <button class="copyBtn" data-copy="code-recipe-key">Copy</button>
              <pre id="code-recipe-key">curl "https://review-assistant-api.onrender.com/me" \
  -H "x-api-key: YOUR_KEY_HERE"</pre>
            </div>
          </div>

          <div style="height:12px;"></div>

          <div class="boxOut">
            <h3 style="margin:0 0 8px 0; color:#e2e8f0; font-size:16px;">Frontend fetch example</h3>
            <div class="codeBox">
              <button class="copyBtn" data-copy="code-recipe-fetch">Copy</button>
              <pre id="code-recipe-fetch">const res = await fetch("https://review-assistant-api.onrender.com/analyze", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "x-api-key": localStorage.getItem("ra_api_key"),
  },
  body: JSON.stringify({
    review_text: "Food was great but the wait was long.",
    platform: "google",
  }),
});

const data = await res.json();</pre>
            </div>
          </div>
        </div>

        <!-- WEBHOOKS -->
        <div id="webhooks" class="card docSection">
          <div class="endpointHead">
            <h2>Webhooks</h2>
            <span class="chip webhook">Stripe</span>
          </div>

          <p style="color:#cbd5e1; line-height:1.7; margin:0;">
            Stripe webhooks provision accounts and trigger API key delivery. Most users don’t need to touch this.
          </p>

          <div style="height:10px;"></div>

          <div class="callout">
            <strong>Tip:</strong> If checkout succeeded but the key hasn’t arrived after a few minutes, check Spam, then contact support.
          </div>
        </div>

        <!-- TROUBLESHOOTING -->
        <div id="troubleshooting" class="card docSection">
          <div class="endpointHead">
            <h2>Troubleshooting</h2>
            <span class="chip">Help</span>
          </div>

          <div class="boxOut">
            <h3 style="margin:0 0 8px 0; color:#e2e8f0; font-size:16px;">If the Dashboard says “Not connected”</h3>
            <ul style="margin:8px 0 0 18px; padding:0; color:#cbd5e1; line-height:1.7;">
              <li>Make sure you pasted the full API key (no extra spaces)</li>
              <li>Click <strong>Load my account</strong></li>
              <li>Try refreshing the page</li>
              <li>If you just checked out, wait a moment (webhook provisioning)</li>
            </ul>
          </div>

          <div style="height:12px;"></div>

          <div class="boxOut">
            <h3 style="margin:0 0 8px 0; color:#e2e8f0; font-size:16px;">If you get a 402</h3>
            <div class="muted" style="margin-top:6px;">
              A 402 typically means billing is inactive (past_due/canceled). You’ll need to update billing.
            </div>
          </div>
        </div>

        <!-- CHANGELOG -->
        <div id="changelog" class="card docSection">
          <div class="endpointHead">
            <h2>Changelog</h2>
            <span class="chip">Tiny</span>
          </div>

          <div class="muted">
            Keep this short. It makes the docs feel “alive”.
          </div>

          <div style="height:10px;"></div>

          <div class="boxOut">
            <div style="color:#e2e8f0; font-weight:900;">2026-01</div>
            <div class="muted" style="margin-top:6px;">
              Dashboard-first UX. Platform detection simplified. Docs and Support pages refined.
            </div>
          </div>
        </div>

        <div class="footer">
          © <span id="yr"></span> RestaurantAssist • Questions? <a href="/support.html">Support</a>
        </div>

      </div>
    </div>
  </div>

  <div id="toast" class="toast">Copied!</div>

  <script>
    document.getElementById("yr").textContent = new Date().getFullYear();

    const toastEl = document.getElementById("toast");
    function toast(text="Copied!"){
      toastEl.textContent = text;
      toastEl.classList.add("show");
      setTimeout(()=>toastEl.classList.remove("show"), 900);
    }

    async function copyFromPre(preId){
      const el = document.getElementById(preId);
      if (!el) return;
      const text = el.textContent || "";
      try{
        await navigator.clipboard.writeText(text);
        toast("Copied");
      }catch(e){
        // fallback
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        toast("Copied");
      }
    }

    document.querySelectorAll(".copyBtn").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-copy");
        copyFromPre(id);
      });
    });
  </script>
</body>
</html>
